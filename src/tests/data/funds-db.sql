CREATE DATABASE testDB;
GO

USE testDB;
EXEC sys.sp_cdc_enable_db;

CREATE TABLE TABLE_RATE (
  MARKCODE varchar(4),
  SECID varchar(20) not null,
  RDATE datetime not null,
  BID decimal(18,16),
  ASK decimal(18,16),
  LOW decimal(18,16),
  HIGH decimal(18,16),
  RCLOSE decimal(18,16),
  MID decimal(18,16),
  VOL decimal(17,15),
  RINDEX decimal(18,16),
  SNAPSHOT varchar(5) not null,
  UPDATE_STAMP timestamp not null,
  UPD_DATE datetime,
  TIS decimal(18,16)
);

CREATE TABLE TABLE_PORTRANS (
  TRANS_NR int(4) not null,
  ORIG_NMBR int(4),
  TRANS_CODE char(2),
  COM_CODE varchar(20),
  PORID varchar(20),
  SEC_TYPE char(2),
  SECID varchar(20),
  ISSUE int(4),
  BROKID varchar(20),
  TRUSTID varchar(50),
  TRUST_NMBR int(4),
  TRANS_DATE datetime,
  VAL_BEGIN datetime,
  VAL_END datetime,
  PMT_DATE datetime,
  AVG_DATE datetime,
  AMOUNT decimal(21,19),
  CURRENCY1 char(3),
  PUR_VALUE decimal(17,15),
  PUR_VALUE2 decimal(17,15),
  PUR_PRICE decimal(18,16),
  CURRENCY2 char(3),
  PAWN_CODE varchar(10),
  CUR_RATE decimal(18,16),
  PUR_CVALUE decimal(17,15),
  BK_VALUE decimal(17,15),
  TAX_DATE datetime,
  TAX_VALUE decimal(17,15),
  RATE_DATE datetime,
  RATE decimal(18,16),
  COM_DIV varchar(20),
  POR_DIV varchar(20),
  PAWN_AM decimal(21,19),
  ACC_DIV decimal(17,15),
  PMT_DIV decimal(17,15),
  DIV_DATE datetime,
  PRELIMTAX decimal(17,15),
  ORDER_VAL datetime,
  ORDER_TIME varchar(8),
  ORDER_NMBR int(4),
  ORDER_AM decimal(21,19),
  ORDER_ORD int(4),
  POFF_DATE datetime,
  POFF_PRICE decimal(18,16),
  POFF_VALUE decimal(17,15),
  TEMP_NR varchar(30),
  AVOIR decimal(17,15),
  ISS_PRINT datetime,
  SPL_DATE datetime,
  SUBS_DATE datetime,
  SUBS_BIT int(4),
  NOTE varchar(255),
  CAP_DIFF decimal(17,15),
  CHG_VALUE decimal(17,15),
  UPD_USER varchar(30),
  UPD_DATE datetime,
  UPD_TIME varchar(8),
  OWN_TYPE char(1),
  RED_DATE datetime,
  EXT_NR varchar(250),
  BK_CVALUE decimal(17,15),
  BE_ACCOUNT varchar(20),
  FEE decimal(17,15),
  PROVISION decimal(12,10),
  EXPENSES decimal(17,15),
  UMBRELLA varchar(10),
  CHG_RATE decimal(18,16),
  CURR_CHG decimal(17,15),
  EFF_YIELD decimal(18,16),
  DATE1 datetime,
  DATE2 datetime,
  VALUE1 decimal(17,15),
  VALUE2 decimal(17,15),
  VALUE3 decimal(12,10),
  VALUE4 decimal(12,10),
  CODE1 int(4),
  CODE2 int(4),
  CODE3 char(2),
  CODE4 varchar(12),
  CODE5 varchar(30),
  ISIN varchar(12),
  OWN_BEGIN datetime,
  OWN_END datetime,
  CAMOUNT decimal(21,19),
  PUR_CVALU2 decimal(17,15),
  CHG_CVALUE decimal(17,15),
  CAP_CDIFF decimal(17,15),
  CUR_RATE2 decimal(18,16),
  CHG_RATE2 decimal(18,16),
  PAWN_CURR char(3),
  DIV_BIT int(4),
  PUR_CPRICE decimal(18,16),
  AVG_PMT datetime,
  PUR_DATE datetime,
  REF_INDEX decimal(21,19),
  INDEXDATE datetime,
  REASON int(4),
  CHG_FVALUE decimal(17,15),
  CHG_CFVALUE decimal(17,15),
  FIFO_NMBR int(4),
  UPDATE_STAMP timestamp not null,
  SUBSCR_RIGHT1 int(4),
  SUBSCR_RIGHT2 int(4)
);

CREATE TABLE TABLE_RATELAST (
  MARKCODE varchar(4),
  SECID varchar(20) not null,
  RDATE datetime,
  BID decimal(18,16),
  ASK decimal(18,16),
  LOW decimal(18,16),
  HIGH decimal(18,16),
  RCLOSE decimal(18,16),
  MID decimal(18,16),
  VOL decimal(17,15),
  RINDEX decimal(18,16),
  SNAPSHOT varchar(5) not null,
  UPDATE_STAMP timestamp not null,
  UPD_DATE datetime,
  TIS decimal(18,16)
);

EXEC sys.sp_cdc_enable_table @source_schema = 'dbo', @source_name = 'TABLE_RATE', @role_name = NULL, @supports_net_changes = 0;
EXEC sys.sp_cdc_enable_table @source_schema = 'dbo', @source_name = 'TABLE_PORTRANS', @role_name = NULL, @supports_net_changes = 0;
EXEC sys.sp_cdc_enable_table @source_schema = 'dbo', @source_name = 'TABLE_RATELAST', @role_name = NULL, @supports_net_changes = 0;
GO